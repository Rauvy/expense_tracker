from datetime import UTC, datetime  # –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º UTC –∏ datetime –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≤—Ä–µ–º–µ–Ω–µ–º
from typing import Optional  # Optional –Ω—É–∂–µ–Ω –¥–ª—è –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π

from beanie import (  # Document ‚Äî –º–æ–¥–µ–ª—å –¥–ª—è MongoDB, PydanticObjectId ‚Äî ID-—à–∫–∞
    Document,
    PydanticObjectId,
)
from pydantic import (  # EmailStr ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ email, Field ‚Äî –¥–ª—è –∑–∞–¥–∞–Ω–∏—è default –∑–Ω–∞—á–µ–Ω–∏–π
    EmailStr,
    Field,
)


# –ú–æ–¥–µ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ "users"
class User(Document):
    email: EmailStr  # –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ email, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è
    hashed_password: str  # –ü–∞—Ä–æ–ª—å –≤ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ

    class Settings:
        name = "users"  # –ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –≤ MongoDB


# –ú–æ–¥–µ–ª—å —Ä–∞—Å—Ö–æ–¥–∞ (—Ç—Ä–∞—Ç—ã), –±—É–¥–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ "expenses"
class Expense(Document):
    title: str  # –ù–∞–∑–≤–∞–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ü—Ä–æ–¥—É–∫—Ç—ã", "–ö–∞—Ñ–µ")
    amount: float  # –°—É–º–º–∞ —Ä–∞—Å—Ö–æ–¥–∞
    category: str | None = None  # –ö–∞—Ç–µ–≥–æ—Ä–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ï–¥–∞", "–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç"), –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç—ã–º
    payment_method: str | None = (
        None  # üí≥ –°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, "Visa", "Cash"), –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç—ã–º
    )
    saved_at: datetime = Field(default_factory=lambda: datetime.now(UTC))
    # –î–∞—Ç–∞ —Ä–∞—Å—Ö–æ–¥–∞, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è –≤ UTC

    user_id: PydanticObjectId  # ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä–æ–º—É –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç —Ä–∞—Å—Ö–æ–¥

    class Settings:
        name = "expenses"  # –ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –≤ MongoDB


# üîê –ú–æ–¥–µ–ª—å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è refresh —Ç–æ–∫–µ–Ω–æ–≤ –≤ MongoDB
class RefreshToken(Document):
    user_id: str  # ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä–æ–º—É –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç —Ç–æ–∫–µ–Ω
    token: str  # –°–∞–º refresh —Ç–æ–∫–µ–Ω (—É–Ω–∏–∫–∞–ª—å–Ω–∞—è —Å—Ç—Ä–æ–∫–∞)
    created_at: datetime  # –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è, –∫–æ–≥–¥–∞ —Ç–æ–∫–µ–Ω –±—ã–ª —Å–æ–∑–¥–∞–Ω
    expires_at: datetime  # –°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è —Ç–æ–∫–µ–Ω–∞ (–ø–æ—Å–ª–µ —ç—Ç–æ–π –¥–∞—Ç—ã –æ–Ω —Å—á–∏—Ç–∞–µ—Ç—Å—è –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º)

    class Settings:
        name = "refresh_tokens"  # üëà –£–∫–∞–∑—ã–≤–∞–µ–º –∏–º—è –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –≤ MongoDB